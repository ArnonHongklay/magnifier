!function(a){var e={character:{DIGIT:1,LOWERCASE:2,UPPERCASE:4,PUNCTUATION:8},strength:{LOW:0,MEDIUM:1,HIGH:2,EXTREME:3},dictionary:[],patterns:["0123456789","abcdefghijklmnopqrstuvwxyz","qwertyuiopasdfghjklzxcvbnm","azertyuiopqsdfghjklmwxcvbn","!#$*+-.:?@^"],threshold:{medium:16,high:22,extreme:36}};e.requirements={characters:e.character.DIGIT|e.character.LOWERCASE|e.character.UPPERCASE,length:{min:6,max:1/0}},Object.seal&&(Object.seal(e.character),Object.seal(e.strength)),Object.freeze&&(Object.freeze(e.character),Object.freeze(e.strength)),e.analize=function(e){var t=Math.floor(2*e.length),r=e.length;for(t+=a.passy.analizePatterns(e),t+=a.passy.analizeDictionary(e);r--;)t+=a.passy.analizeCharacter(e.charAt(r));return a.passy.analizeScore(t)},e.analizeCharacter=function(a){var e=a.charCodeAt(0);return e>=97&&122>=e?1:e>=48&&57>=e?2:e>=65&&90>=e?3:126>=e?4:5},e.analizePattern=function(a,e){for(var t=-1,r=-2,n=0;n<a.length;n++){var s=e.indexOf(a.charAt(n));t===s-1&&(t=s,r++)}return Math.max(0,r)},e.analizePatterns=function(e){var t=e.toLowerCase(),r=0;for(var n in a.passy.patterns){var s=a.passy.patterns[n].toLowerCase();r+=a.passy.analizePattern(t,s)}return-5*r},e.analizeDictionary=function(e){var t=(e.toLowerCase(),0);for(var r in a.passy.dictionary){var n=a.passy.dictionary[r].toLowerCase();e.indexOf(n)>=0&&t++}return-5*t},e.analizeScore=function(e){return e>=a.passy.threshold.extreme?a.passy.strength.EXTREME:e>=a.passy.threshold.high?a.passy.strength.HIGH:e>=a.passy.threshold.medium?a.passy.strength.MEDIUM:a.passy.strength.LOW},e.generate=function(e){var t,r,n=["0123456789","abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ","!#$&()*+<=>@[]^"],s=[];for(e=Math.max(e,a.passy.requirements.length.min),e=Math.min(e,a.passy.requirements.length.max);e--;)t=e%n.length,r=Math.floor(Math.random()*n[t].length),s.push(n[t].charAt(r));return s.sort(function(){return 2*Math.random()-1}),s.join("")},e.contains=function(e,t){return t===a.passy.character.DIGIT?/\d/.test(e):t===a.passy.character.LOWERCASE?/[a-z]/.test(e):t===a.passy.character.UPPERCASE?/[A-Z]/.test(e):t===a.passy.character.PUNCTUATION?/[!"#$%&'()*+,\-./:;<=>?@[\\]\^_`{\|}~]/.test(e):void 0},e.valid=function(e){var t=!0;if(!a.passy.requirements)return!0;if(e.length<a.passy.requirements.length.min)return!1;if(e.length>a.passy.requirements.length.max)return!1;for(var r in a.passy.character)a.passy.requirements.characters&a.passy.character[r]&&(t=a.passy.contains(e,a.passy.character[r])&&t);return t};var t={init:function(e){var r=a(this);r.on("change keyup",function(){if("function"==typeof e){var n=r.val();e.call(r,a.passy.analize(n),t.valid.call(r))}})},generate:function(e){this.val(a.passy.generate(e)),this.change()},valid:function(){return a.passy.valid(this.val())}};a.fn.passy=function(a){return t[a]?t[a].apply(this,Array.prototype.slice.call(arguments,1)):"function"!=typeof a&&a?this:t.init.apply(this,arguments)},a.extend({passy:e})}(jQuery);